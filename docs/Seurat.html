<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Denny Shin" />

<meta name="date" content="2018-08-13" />

<title>Seurat</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Learning. Thoughts</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jdblischak/workflowr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Seurat</h1>
<h4 class="author"><em>Denny Shin</em></h4>
<h4 class="date"><em>2018-08-13</em></h4>

</div>


<p><strong>Last updated:</strong> 2018-08-14</p>
<strong>workflowr checks:</strong> <small>(Click a bullet for more information)</small>
<ul>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>R Markdown file:</strong> up-to-date </summary></p>
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Environment:</strong> empty </summary></p>
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Seed:</strong> <code>set.seed(20180724)</code> </summary></p>
<p>The command <code>set.seed(20180724)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Session information:</strong> recorded </summary></p>
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Repository version:</strong> <a href="https://github.com/dennyshin/Learning-Thoughts/tree/0378f6512d52f10716172d3fa3b85d565865d2b8" target="_blank">0378f65</a> </summary></p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
<pre><code>
Ignored files:
    Ignored:    .Rhistory

Untracked files:
    Untracked:   (DESKTOP-9MQETIV's conflicted copy 2018-07-26).Rhistory
    Untracked:  Learning-Thoughts.Rproj
    Untracked:  data/pbmc3k_filtered_gene_bc_matrices/
    Untracked:  output/pbmc3k_final.rds
    Untracked:  output/pbmc_tutorial.rds

Unstaged changes:
    Deleted:    Learning. Thoughts.Rproj
    Modified:   analysis/long-read-seq-CACNA1C.Rmd

</code></pre>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes. </details>
</li>
</ul>
<details> <summary> <small><strong>Expand here to see past versions:</strong></small> </summary>
<ul>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
File
</th>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/dennyshin/Learning-Thoughts/blob/0378f6512d52f10716172d3fa3b85d565865d2b8/analysis/Seurat.Rmd" target="_blank">0378f65</a>
</td>
<td style="text-align:left;">
Denny Shin
</td>
<td style="text-align:left;">
2018-08-14
</td>
<td style="text-align:left;">
added seurat page, expanded on single cell rnaseq
</td>
</tr>
</tbody>
</table>
</ul>
<p></details></p>
<hr />
<div id="introduction" class="section level2">
<h2><strong>Introduction</strong></h2>
<p>I will be following through the code written <a href="https://satijalab.org/seurat/pbmc3k_tutorial.html">here</a></p>
<p>It uses the packages Seurat and dplyr. The Seurat package takes a while.</p>
</div>
<div id="setup-the-seurat-object" class="section level2">
<h2><strong>Setup the Seurat Object</strong></h2>
<pre class="r"><code># Load the PBMC dataset
pbmc.data &lt;- Read10X(data.dir = &quot;../data/pbmc3k_filtered_gene_bc_matrices/filtered_gene_bc_matrices/hg19/&quot;)

# Examine the memory savings between regular and sparse matrices
dense.size &lt;- object.size(x = as.matrix(x = pbmc.data))
dense.size

sparse.size &lt;- object.size(x = pbmc.data)
sparse.size

dense.size/sparse.size</code></pre>
<p>It may take a little to load the dataset, there are 3. pbmc.data is a large matrix with ~90 million elements. I am assuming the second part is from the dplyr package?</p>
<p>My data seems to be a little bigger than the example from the tutorial. This is also seen when I did the sparse.size and its ratio to dense.size.</p>
<pre class="r"><code># Initialize the Seurat object with the raw (non-normalized data).  Keep all genes expressed in &gt;= 3 cells (~0.1% of the data). Keep all cells with at least 200 detected genes
pbmc &lt;- CreateSeuratObject(raw.data = pbmc.data, min.cells = 3, min.genes = 200, project = &quot;10X_PBMC&quot;)</code></pre>
<p>This made a large seurat (dunno what that is). The 10X_PBMC is confusing, is it just naming it?</p>
</div>
<div id="standard-pre-processing-workflow" class="section level1">
<h1><strong>Standard pre-processing workflow</strong></h1>
<div id="qc-and-selecting-cells-for-further-analysis" class="section level2">
<h2><strong>QC and selecting cells for further analysis</strong></h2>
<pre class="r"><code>mito.genes &lt;- grep(pattern = &quot;^MT-&quot;, x = rownames(x = pbmc@data), value = TRUE)
percent.mito &lt;- Matrix::colSums(pbmc@raw.data[mito.genes, ])/Matrix::colSums(pbmc@raw.data)

pbmc &lt;- AddMetaData(object = pbmc, metadata = percent.mito, col.name = &quot;percent.mito&quot;)
VlnPlot(object = pbmc, features.plot = c(&quot;nGene&quot;, &quot;nUMI&quot;, &quot;percent.mito&quot;), nCol = 3)</code></pre>
<p>There is a lot of detail as to how the functions work but I can’t make head to tail of it either way.</p>
<p>grep is just a function that utilises regex and makes making repeating similar names easier. I think percent.mito is finding some kind of proportion of mito?</p>
<p>I can make all the plots no problem but I don’t really have any idea about the first one.</p>
<pre class="r"><code>par(mfrow = c(1, 2))
GenePlot(object = pbmc, gene1 = &quot;nUMI&quot;, gene2 = &quot;percent.mito&quot;)
GenePlot(object = pbmc, gene1 = &quot;nUMI&quot;, gene2 = &quot;nGene&quot;)</code></pre>
<p>I guess the second plots are looking at the relationship between nUMI and percent.mito or nGene. There is a linear correlation between nUMI and nGene. Not really sure what to make of the percen.mito graph. Don’t know what the number above the graphs mean.</p>
<pre class="r"><code>pbmc &lt;- FilterCells(object = pbmc, subset.names = c(&quot;nGene&quot;, &quot;percent.mito&quot;), low.thresholds = c(200, -Inf), high.thresholds = c(2500, 0.05))</code></pre>
<p>I’m not sure about the reason why we are filtering some cells out.</p>
</div>
<div id="normalizing-the-data" class="section level2">
<h2><strong>Normalizing the data</strong></h2>
<p>Its lognormalize with a scale factor of 10,000. I don’t know what this does or why we did it.</p>
</div>
<div id="detection-of-variable-genese-across-the-single-cells" class="section level2">
<h2><strong>Detection of variable genese across the single cells</strong></h2>
<pre class="r"><code>pbmc &lt;- FindVariableGenes(object = pbmc, mean.function = ExpMean, dispersion.function = LogVMR, x.low.cutoff = 0.0125, x.high.cutoff = 3, y.cutoff = 0.5)</code></pre>
<p>Ok, I have done something horribly wrong here because the plot does not come out the same. It does mention that the parameters should depend on the data and how you want to view it.</p>
<pre class="r"><code>length(x = pbmc@var.genes)</code></pre>
<p>Again my length is not the same.</p>
</div>
<div id="scaling-the-data-and-removing-unwanted-sources-of-variation" class="section level2">
<h2><strong>Scaling the data and removing unwanted sources of variation</strong></h2>
<p>We want to remove technical noise and also biological variation (e.g. cell cycle stage).</p>
<pre class="r"><code>pbmc &lt;- ScaleData(object = pbmc, vars.to.regress = c(&quot;nUMI&quot;, &quot;percent.mito&quot;))</code></pre>
<p>This may take a bit. There is a nice animation too. It also needs a firewall permission.</p>
</div>
<div id="perform-linear-dimensional-reduction" class="section level2">
<h2><strong>Perform linear dimensional reduction</strong></h2>
<p>We are doing PCA here.</p>
<pre class="r"><code>pbmc &lt;- RunPCA(object = pbmc, pc.genes = pbmc@var.genes, do.print = TRUE, pcs.print = 1:5, genes.print = 5)</code></pre>
<p>Seurat can visualise PCA by printing or plotting (VizPCA, PCAPlot).</p>
<pre class="r"><code>PrintPCA(object = pbmc, pcs.print = 1:5, genes.print = 5, use.full = FALSE)
VizPCA(object = pbmc, pcs.use = 1:2)
PCAPlot(object = pbmc, dim.1 = 1, dim.2 = 2)</code></pre>
<p>Yeah, I think I definetly have different data from the example in the tutorial. I don’t know why though.</p>
<pre class="r"><code>pbmc &lt;- ProjectPCA(object = pbmc, do.print = FALSE)</code></pre>
<p>I don’t really understand what this is for.</p>
<p>It can also do PCA heatmaps.</p>
<pre class="r"><code>PCHeatmap(object = pbmc, pc.use = 1, cells.use = 500, do.balanced = TRUE, label.columns = FALSE)</code></pre>
<p>When I ran it, I got a warning saying ‘“dimTitle” is not a graphical parameter’.</p>
<pre class="r"><code>PCHeatmap(object = pbmc, pc.use = 1:12, cells.use = 500, do.balanced = TRUE, label.columns = FALSE, use.full = FALSE)</code></pre>
</div>
<div id="determine-statistically-significant-principal-components" class="section level2">
<h2><strong>Determine statistically significant principal components</strong></h2>
<pre class="r"><code>pbmc &lt;- JackStraw(object = pbmc, num.replicate = 100, display.progress = FALSE)
JackStrawPlot(object = pbmc, PCs = 1:12)</code></pre>
<pre class="r"><code>PCElbowPlot(object = pbmc)</code></pre>
</div>
<div id="cluster-the-cells" class="section level2">
<h2><strong>Cluster the cells</strong></h2>
<pre class="r"><code>pbmc &lt;- FindClusters(object = pbmc, reduction.type = &quot;pca&quot;, dims.use = 1:10, resolution = 0.6, print.output = 0, save.SNN = TRUE)

PrintFindClustersParams(object = pbmc)</code></pre>
<p>Seurat’s clustering method is as follows (I think): construct KNN (K-nearest neighbor) graph based on the euclidean distance in PCA, refine using Jaccard similarity and then Louvain algorithm (?).</p>
</div>
<div id="non-linear-dimensional-reduction-tsne" class="section level2">
<h2><strong>Non-linear dimensional reduction (tSNE)</strong></h2>
<pre class="r"><code>pbmc &lt;- RunTSNE(object = pbmc, dims.use = 1:10, do.fast = TRUE)

TSNEPlot(object = pbmc)</code></pre>
<p>Looks pretty. More about t-SNE (t-distributed stochastic neighbor embedding) <a href="https://distill.pub/2016/misread-tsne/">here</a>.</p>
<p>You can save this by using saveRDS()</p>
<pre class="r"><code>saveRDS(pbmc, file = &quot;../output/pbmc_tutorial.rds&quot;)</code></pre>
</div>
<div id="finding-differentially-expressed-genes-cluster-biomarkers" class="section level2">
<h2><strong>Finding differentially expressed genes (cluster biomarkers)</strong></h2>
<p>Seurat can find clusters using differential expression, FindAllMarkers(). min.pct is the minimum percentage the gene requires to be detected. Setting this to zero will make the function test a large number of genes that are unlikely to be differential (lot of compute time needed). max.cells.per.ident also speeds things up but I don’t quite get why.</p>
<pre class="r"><code>cluster1.markers &lt;- FindMarkers(object = pbmc, ident.1 = 1, min.pct = 0.25)
print(x = head(x = cluster1.markers, n = 5))

cluster5.markers &lt;- FindMarkers(object = pbmc, ident.1 = 5, ident.2 = c(0, 3), min.pct = 0.25)
print(x = head(x = cluster5.markers, n = 5))

pbmc.markers &lt;- FindAllMarkers(object = pbmc, only.pos = TRUE, min.pct = 0.25, thresh.use = 0.25)
pbmc.markers %&gt;% group_by(cluster) %&gt;% top_n(2, avg_logFC)

VlnPlot(object = pbmc, features.plot = c(&quot;MS4A1&quot;, &quot;CD79A&quot;))

# raw UMI counts included
VlnPlot(object = pbmc, features.plot = c(&quot;NKG7&quot;, &quot;PF4&quot;), use.raw = TRUE, y.log = TRUE)

FeaturePlot(object = pbmc, features.plot = c(&quot;MS4A1&quot;, &quot;GNLY&quot;, &quot;CD3E&quot;, &quot;CD14&quot;, &quot;FCER1A&quot;, &quot;FCGR3A&quot;, &quot;LYZ&quot;, &quot;PPBP&quot;, &quot;CD8A&quot;), cols.use = c(&quot;grey&quot;, &quot;blue&quot;), reduction.use = &quot;tsne&quot;)</code></pre>
<p>Ok, that took really long. The FindAllMarkers for the pbmc.markers took ~5mins.</p>
<p>I don’t understand the Vln plots.</p>
<p>The tutorial mentions alternate test methods can be used here (e.g. ROC test) and it can be changed using test.use.</p>
<p>A heatmap can also be done.</p>
<pre class="r"><code>top10 &lt;- pbmc.markers %&gt;% group_by(cluster) %&gt;% top_n(10, avg_logFC)

DoHeatmap(object = pbmc, genes.use = top10$gene, slim.col.label = TRUE, remove.key = TRUE)</code></pre>
</div>
<div id="assigning-cell-type-identity-to-clusters" class="section level2">
<h2><strong>Assigning cell type identity to clusters</strong></h2>
<p>Ok, I can see that he has given an ID to each cell type in the tutorial. But I think I have different data to him. So, I’m not sure I’m able to make anything useful here. I can still try with some of the parameters left out:</p>
<pre class="r"><code>pbmc@ident &lt;- plyr::mapvalues(x = pbmc@ident)
TSNEPlot(object = pbmc, do.label = TRUE, pt.size = 0.5)</code></pre>
<p>Yeah this comes up with an error saying the argument “from” is missing. So I definetly need to made the cluster ID number to the cluster name.</p>
<p>If I try it with the same IDs and cell types in the tutorial:</p>
<pre class="r"><code>current.cluster.ids &lt;- c(0, 1, 2, 3, 4, 5, 6, 7)
new.cluster.ids &lt;- c(&quot;CD4 T cells&quot;, &quot;CD14+ Monocytes&quot;, &quot;B cells&quot;, &quot;CD8 T cells&quot;, &quot;FCGR3A+ Monocytes&quot;, &quot;NK cells&quot;, &quot;Dendritic cells&quot;, &quot;Megakaryocytes&quot;)
pbmc@ident &lt;- plyr::mapvalues(x = pbmc@ident, from = current.cluster.ids, to = new.cluster.ids)
TSNEPlot(object = pbmc, do.label = TRUE, pt.size = 0.5)</code></pre>
<p>Some of the cell types seem to be missing. I still think it’s because I have different data from the tutorial but I may have made some small mistake along the way I’m not sure.</p>
</div>
<div id="further-subdivisions-within-cell-types" class="section level2">
<h2><strong>Further subdivisions within cell types</strong></h2>
<pre class="r"><code>pbmc &lt;- StashIdent(object = pbmc, save.name = &quot;ClusterNames_0.6&quot;)

pbmc &lt;- FindClusters(object = pbmc, reduction.type = &quot;pca&quot;, dims.use = 1:10, resolution = 0.8, print.output = FALSE)</code></pre>
<p>The output told me to set force.recalc to TRUE. But I think the tutorial ignores the warning and moves on.</p>
<pre class="r"><code>pbmc &lt;- FindClusters(object = pbmc, reduction.type = &quot;pca&quot;, dims.use = 1:10, resolution = 0.8, print.output = FALSE, force.recalc = TRUE)</code></pre>
<pre class="r"><code>plot1 &lt;- TSNEPlot(object = pbmc, do.return = TRUE, no.legend = TRUE, do.label = TRUE)
plot2 &lt;- TSNEPlot(object = pbmc, do.return = TRUE, group.by = &quot;ClusterNames_0.6&quot;, 
    no.legend = TRUE, do.label = TRUE)
plot_grid(plot1, plot2)</code></pre>
<pre class="r"><code>tcell.markers &lt;- FindMarkers(object = pbmc, ident.1 = 0, ident.2 = 1)

FeaturePlot(object = pbmc, features.plot = c(&quot;S100A4&quot;, &quot;CCR7&quot;), cols.use = c(&quot;green&quot;, &quot;blue&quot;))</code></pre>
<p>We can save our work for now by:</p>
<pre class="r"><code>pbmc &lt;- SetAllIdent(object = pbmc, id = &quot;ClusterNames_0.6&quot;)
saveRDS(pbmc, file = &quot;../output/pbmc3k_final.rds&quot;)</code></pre>
<p>I understand the saveRDS but I don’t know why we have to do the SetAllIdent</p>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.5.0 (2018-04-23)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 17713)

Matrix products: default

locale:
[1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252   
[3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C                      
[5] LC_TIME=English_Australia.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] workflowr_1.1.1   Rcpp_0.12.18      digest_0.6.15    
 [4] rprojroot_1.3-2   R.methodsS3_1.7.1 backports_1.1.2  
 [7] git2r_0.23.0      magrittr_1.5      evaluate_0.11    
[10] stringi_1.1.7     whisker_0.3-2     R.oo_1.22.0      
[13] R.utils_2.6.0     rmarkdown_1.10    tools_3.5.0      
[16] stringr_1.3.1     yaml_2.1.19       compiler_3.5.0   
[19] htmltools_0.3.6   knitr_1.20       </code></pre>
</div>
</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<hr>
<p>
  This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a>
  analysis was created with
  <a href="https://github.com/jdblischak/workflowr">workflowr</a> 1.1.1
</p>
<hr>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
